var cities=[],substringMatcher=function(e){return function(t,a){var n;n=[],substrRegex=new RegExp(t,"i"),$.each(e,function(e,t){substrRegex.test(t)&&n.push(t)}),a(n)}};$.getJSON("city.list.json",function(e){$.each(e,function(e,t){cities.push(t.name)})}).fail(function(e,t,a){var n=t+", "+a;console.log("Request Failed: "+n)}),$("#the-basics .typeahead").typeahead({hint:!0,highlight:!0,minLength:1},{name:"cities",source:substringMatcher(cities)}),jQuery(document).ready(function(e){var t=e("#search");t.on("typeahead:selected",function(t,a){var n=a,r="http://api.openweathermap.org/data/2.5/weather?appid=68d06ff44fb97dc7a6ea98b54f8374ba&callback=",s={mode:"JSON",units:"metric",q:n},i=function(e){var t=new Date(1e3*e),a=t.getHours()<10?"0"+t.getHours():t.getHours(),n=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),r=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),s=a+":"+n+":"+r;return s},c=function(e){var t=new Date(1e3*e),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=t.getFullYear(),r=a[t.getMonth()],s=t.getDate(),i=s+" "+r+" "+n;return i};Handlebars.registerHelper("time",function(e){e=Handlebars.Utils.escapeExpression(e);var t=i(e);return new Handlebars.SafeString(t)}),Handlebars.registerHelper("date",function(e){e=Handlebars.Utils.escapeExpression(e);var t=c(e);return new Handlebars.SafeString(t)}),Handlebars.registerHelper("displayWeatherIcon",function(e,t){e=Handlebars.Utils.escapeExpression(e),t=Handlebars.Utils.escapeExpression(t);var a='<img src="http://openweathermap.org/img/w/'+e+'.png" alt="'+t+'" class="weather-icon">';return new Handlebars.SafeString(a)}),e.ajax(r,{dataType:"json",data:s,success:function(t){var a=Handlebars.templates.display_weather,n=a(t);e("ul.list").html(n)},error:function(e,t,a){var n=t+", "+a;console.log("Request Failed: "+n)}})}),t.on("click",function(){t.val("")})});